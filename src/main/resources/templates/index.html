<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Oficial | Agroindustrias Acora</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-acora sticky-top">
        <div class="container">
            <a class="navbar-brand brand-text" href="#">
                <i class="bi bi-tree-fill"></i> OLIVOS ACORA
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navContent">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navContent">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item"><a class="nav-link active" href="#">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#productos">Productos</a></li>
                    <li class="nav-item"><a class="nav-link" href="#nosotros">Nosotros</a></li>
                    
                    <li class="nav-item ms-3" th:if="${session.usuarioLogueado == null}">
                        <a href="/login" class="btn btn-outline-success rounded-pill px-4">Ingresar</a>
                    </li>

                    <li class="nav-item ms-3 d-flex align-items-center gap-3" th:if="${session.usuarioLogueado != null}">
                        <button class="btn btn-warning position-relative text-white" data-bs-toggle="modal" data-bs-target="#modalCarrito">
                            <i class="bi bi-cart3"></i>
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="cartCount">0</span>
                        </button>
                        
                        <div class="dropdown">
                            <button class="btn btn-light dropdown-toggle border" type="button" data-bs-toggle="dropdown">
                                <i class="bi bi-person-circle text-success"></i> <span th:text="${session.usuarioLogueado}">Usuario</span>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="/mis-pedidos">Mis Pedidos</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item text-danger" href="/logout">Cerrar Sesión</a></li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <header class="hero-section d-flex align-items-center text-white">
    <div class="container text-center">
        <h1 class="display-2 fw-bold mb-4">El Sabor Auténtico de La Yarada</h1>
        <p class="lead mb-5 fs-4 w-md-75 mx-auto">Aceitunas y aceites premium, cultivados con tradición y procesados con pasión para tu mesa.</p>
        <a href="#productos" class="btn btn-warning btn-lg rounded-pill px-5 py-3 fw-bold shadow-lg text-dark">
            <i class="bi bi-shop me-2"></i> DESCUBRIR CATÁLOGO
        </a>
    </div>
</header>

<section id="nosotros" class="py-5 bg-white">
    <div class="container py-5">
        <div class="row align-items-center gx-lg-5">
            <div class="col-lg-6 mb-4 mb-lg-0">
                <img src="https://i.pinimg.com/originals/b7/68/3b/b7683b9a35b64512e2eab6de47a228ee.jpg" 
                     alt="Nuestra Tradición Olivera" class="img-fluid rounded-4 shadow-lg">
            </div>
            
            <div class="col-lg-6">
                <h6 class="text-success fw-bold text-uppercase mb-3" style="letter-spacing: 2px;">Nuestra Pasión</h6>
                <h2 class="fw-bold display-5 mb-4 text-dark">Tradición Olivera desde 2022</h2>
                <p class="text-muted lead mb-5">
                    En Agroindustrias Acora S.A.C., fusionamos la herencia agrícola de Tacna con estándares modernos de calidad. Cada producto es el resultado de un cuidado meticuloso, desde el cultivo hasta el envasado, respetando nuestra tierra.
                </p>
                
                <div class="row gy-4">
                    <div class="col-md-6">
                        <div class="d-flex align-items-start">
                            <div class="icon-box bg-success bg-opacity-10 text-success rounded-circle me-3">
                                <i class="bi bi-award-fill fs-3"></i>
                            </div>
                            <div>
                                <h5 class="fw-bold mb-1 text-dark">Calidad Premium</h5>
                                <p class="text-muted small mb-0">Selección manual de los mejores frutos para asegurar la excelencia.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-start">
                            <div class="icon-box bg-warning bg-opacity-10 text-warning rounded-circle me-3">
                                <i class="bi bi-flower1 fs-3"></i>
                            </div>
                            <div>
                                <h5 class="fw-bold mb-1 text-dark">100% Natural</h5>
                                <p class="text-muted small mb-0">Proceso artesanal sin conservantes ni aditivos artificiales.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

    <section id="productos" class="container py-5 bg-light">
        <div class="container py-5">
            <div class="text-center mb-5">
                <h6 class="text-success fw-bold text-uppercase">Nuestra Selección</h6>
                <h2 class="fw-bold text-dark display-5">Catálogo de Productos</h2>
            </div>
            
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                
                <div class="col" th:each="prod : ${productos}">
                    <div class="product-card h-100">
                        <div style="height: 250px; overflow: hidden;">
    <img th:src="${prod.imagen != null && prod.imagen != '' ? prod.imagen : 'https://dummyimage.com/600x400/6b8e23/fff&text=Sin+Imagen'}" 
         class="card-img-top h-100 w-100" 
         style="object-fit: cover;"
         alt="Imagen Producto">
</div>
                             
                        <div class="card-body text-center p-4">
                            <small class="text-muted text-uppercase" th:text="${prod.categoria}">CATEGORIA</small>
                            <h5 class="fw-bold my-2" th:text="${prod.nombre}">NOMBRE PRODUCTO</h5>
                            <p class="text-muted small" th:text="${prod.descripcion}">Descripción...</p>
                            
                            <h4 class="text-success fw-bold mb-3" th:text="${'S/ ' + prod.precio}">S/ 0.00</h4>

<button class="btn btn-add w-100 rounded-pill mt-2" 
        th:if="${session.usuarioLogueado != null}" 
        th:data-id="${prod.id}"
        th:data-nombre="${prod.nombre}"
        th:data-precio="${prod.precio}"
        onclick="agregarDesdeBoton(this)">
    <i class="bi bi-cart-plus"></i> Añadir
</button>

<button class="btn btn-add w-100 rounded-pill mt-2" 
        th:if="${session.usuarioLogueado == null}"
        onclick="irALogin()">
    <i class="bi bi-cart-plus"></i> Añadir
</button>
                            
                            <a href="/login" class="btn btn-outline-secondary w-100 rounded-pill mt-2" 
                               th:if="${session.usuarioLogueado == null}">
                               <i class="bi bi-lock"></i> Iniciar Sesión para Comprar
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-12 text-center" th:if="${#lists.isEmpty(productos)}">
                    <p class="lead text-muted">No hay productos disponibles en este momento.</p>
                </div>

            </div>
        </div>
    </section>

    <footer id="contacto" class="bg-dark text-white py-5">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-4">
                    <h4 class="fw-bold text-success mb-3 font-serif">OLIVOS ACORA</h4>
                    <p class="small text-white-50">Empresa líder en la producción y comercialización de aceitunas y derivados.</p>
                </div>
                <div class="col-lg-4">
                    <h5 class="fw-bold mb-3">Enlaces Rápidos</h5>
                    <ul class="list-unstyled text-white-50">
                        <li><a href="#" class="text-white-50 text-decoration-none">Inicio</a></li>
                        <li><a href="#productos" class="text-white-50 text-decoration-none">Productos</a></li>
                        <li><a href="#nosotros" class="text-white-50 text-decoration-none">Nuestra Empresa</a></li>
                        <li><a href="/login" class="text-white-50 text-decoration-none">Mi Cuenta</a></li>
                    </ul>
                </div>
                <div class="col-lg-4">
                    <h5 class="fw-bold mb-3">Contáctanos</h5>
                    <p class="small mb-1"><i class="bi bi-telephone me-2"></i> +51 952 123 456</p>
                    <p class="small mb-1"><i class="bi bi-envelope me-2"></i> ventas@olivosacora.com</p>
                </div>
            </div>
            <hr class="my-4 border-secondary">
            <div class="text-center small text-white-50">
                &copy; 2025 Agroindustrias Acora S.A.C.
            </div>
        </div>
    </footer>

    <div class="modal fade" id="modalCarrito" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title fw-bold"><i class="bi bi-cart3"></i> Mi Carrito</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table align-middle">
                            <thead class="table-light">
                                <tr>
                                    <th>Producto</th>
                                    <th>Precio</th>
                                    <th>Cant.</th>
                                    <th>Subtotal</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="tablaCarrito"></tbody>
                        </table>
                    </div>
                    <div class="d-flex justify-content-end align-items-center mt-3">
                        <h4 class="fw-bold text-secondary me-3">Total: S/ <span id="cartTotal">0.00</span></h4>
                        <button class="btn btn-success fw-bold px-4" id="btnIrPagar" disabled onclick="abrirPasarela()">
                            PROCEDER AL PAGO <i class="bi bi-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalPago" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold text-secondary">Finalizar Compra</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success d-flex justify-content-between fw-bold">
                        <span>Total a Pagar:</span>
                        <span id="pagoTotal">S/ 0.00</span>
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-bold small text-muted">Tipo de Comprobante:</label>
                        <select class="form-select border-success" id="tipoComprobante">
                            <option value="BOLETA">Boleta de Venta</option>
                            <option value="FACTURA">Factura</option>
                        </select>
                    </div>

                    <h6 class="fw-bold mb-3">Seleccione Método de Pago:</h6>
                    
                    <ul class="nav nav-pills mb-3 nav-fill" id="pills-tab" role="tablist">
                        <li class="nav-item">
                            <button class="nav-link active fw-bold" data-bs-toggle="pill" data-bs-target="#pills-yape" type="button" onclick="iniciarSimulacionYape()">
                                <i class="bi bi-qr-code"></i> Yape / Plin
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link fw-bold" data-bs-toggle="pill" data-bs-target="#pills-card" type="button">
                                <i class="bi bi-credit-card"></i> Tarjeta
                            </button>
                        </li>
                    </ul>

                    <div class="tab-content" id="pills-tabContent">
                        <div class="tab-pane fade show active text-center" id="pills-yape">
                            <div class="qr-container mb-3">
                                <p class="small text-muted mb-2">Escanea el código QR</p>
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=PagoOnlineAcora" alt="QR">
                                <div id="yapeStatus" class="mt-3 text-warning fw-bold small">Esperando escaneo...</div>
                            </div>
                            <button class="btn btn-success w-100" id="btnConfirmarYape" disabled onclick="finalizarCompra('YAPE')">
                                CONFIRMAR PAGO
                            </button>
                        </div>

                        <div class="tab-pane fade" id="pills-card">
                            <div class="card-simulada mb-3 text-center">
                                <h4 class="mb-3" style="letter-spacing: 3px;">•••• •••• •••• 4242</h4>
                                <div class="d-flex justify-content-between small"><span>TITULAR</span><span>12/28</span></div>
                            </div>
                            <form id="formCard" onsubmit="event.preventDefault(); procesarTarjeta();">
                                <div class="mb-3"><input type="text" class="form-control" placeholder="Número de Tarjeta" required></div>
                                <div class="row g-2 mb-3">
                                    <div class="col-6"><input type="text" class="form-control" placeholder="MM/YY" required></div>
                                    <div class="col-6"><input type="password" class="form-control" placeholder="CVV" required></div>
                                </div>
                                <button type="submit" class="btn btn-dark w-100" id="btnPayCard">PAGAR AHORA</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/shop.js"></script>
</body>
</html>